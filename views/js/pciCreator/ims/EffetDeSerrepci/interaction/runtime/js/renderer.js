/*
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; under version 2
 * of the License (non-upgradable).
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 *
 * Copyright (c) 2016 (original work) Open Assessment Technologies SA;
 *
 */
define(['effetdeserrePCI/interaction/runtime/js/lib/jquery-ui', 
        'css!effetdeserrePCI/interaction/runtime/css/effetdeserre'
    ], function($) {
    'use strict';

    function renderChoices(id, $container, config) {

        var answ;
        //SVG String 
        var svgyellowarrow = 
        '<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="297mm" height="210mm" viewBox="0 0 1052.3622 744.09448" id="svg23701" class="svg23701" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="fleche1.svg"> <defs id="defs23703" /> <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.7" inkscape:cx="596.17719" inkscape:cy="351.26694" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" inkscape:window-width="1920" inkscape:window-height="1017" inkscape:window-x="1672" inkscape:window-y="-8" inkscape:window-maximized="1" /> <metadata id="metadata23706"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <g inkscape:label="Calque 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-308.26772)"> <path style="fill:#ff6600;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.35159135;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 287.66461,483.02029 c 17.22114,-4.51242 33.3137,-8.29347 46.80271,-17.32946 16.50757,-11.05803 26.23096,-21.84206 37.58483,-37.89312 13.29884,-24.02512 27.47856,-57.78082 27.47856,-57.78082 l -18.55661,0.30108 37.80211,-29.20766 24.20789,29.14655 -17.44554,1.36297 c 0,0 -8.10861,26.16843 -19.66935,54.39843 -11.15673,22.29637 -24.62687,46.1822 -46.72353,60.84483 -27.85736,18.48525 -68.01156,24.47554 -103.38283,17.95342 z" id="path24253" class="path24253" inkscape:connector-curvature="0" sodipodi:nodetypes="cscccccccscc" /> <path style="fill:#ffcc00;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.35159135;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 313.73802,758.69281 37.92718,1.79309 -52.10287,78.58225 -82.20893,-62.19789 31.03443,-11.06406 -63.10326,-251.01876 -29.46181,70.22791 11.78472,2.12811 -29.4618,31.92178 -21.2125,-36.17802 12.96319,3.19219 c 0,0 14.59412,-55.51597 7.07084,-80.8685 -11.38704,-38.37294 -37.318294,-70.5826 -65.994454,-103.21375 -28.67615,-32.63115 -106.06249,-92.57315 -106.06249,-92.57315 l 154.379864,-1.06406 c 0,0 69.52609,50.41946 98.97187,84.64109 27.1992,31.61067 74.27579,88.1975 74.27579,88.1975 l -35.77423,24.01781 z" id="path24251" class="path24251" inkscape:connector-curvature="0" sodipodi:nodetypes="cccccccccccssccsccc" /> </g> </svg>';
        var bgandarrows = '<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="204.32385mm" height="126.05231mm" viewBox="0 0 723.98216 446.64207" id="svg4152" class="svg4152" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="rebond.svg"> <defs id="defs4154" /> <sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.7" inkscape:cx="439.07485" inkscape:cy="123.13089" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1680" inkscape:window-height="987" inkscape:window-x="-8" inkscape:window-y="23" inkscape:window-maximized="1" /> <metadata id="metadata4157"> <rdf:RDF> <cc:Work rdf:about=""> <dc:format>image/svg+xml</dc:format> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /> <dc:title></dc:title> </cc:Work> </rdf:RDF> </metadata> <g inkscape:label="Calque 1" inkscape:groupmode="layer" id="layer1" transform="translate(-3.8327617,-0.64791211)"> <path style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 441.57004,301.79048 77.9339,26.62015 38.1274,-29.47707 -34.9776,-4.34659 c -25.6105,-37.87908 -49.3194,-77.50612 -77.1778,-113.39245 -12.1798,-15.48668 -39.3124,-44.13848 -39.3124,-44.13848 l -66.7117,0.42583 67.3493,61.39317 c 28.5905,29.5851 50.7559,62.08648 73.5302,95.77314 z" id="smallfleche" class="smallfleche" inkscape:connector-curvature="0" sodipodi:nodetypes="cccccccccc" inkscape:label="#smallfleche" /> <path style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.46283412;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 409.61974,307.50156 26.3134,19.33384 10.5376,-18.93254 -11.0264,-1.3301 c -11.7962,-21.31139 -17.5178,-42.5715 -32.7665,-59.78977 -6.5385,-7.2784 -18.9369,-22.02626 -31.4586,-26.45689 -12.5217,-4.43063 -43.1917,-0.63442 -43.1917,-0.63442 0,0 5.0753,1.9452 18.4868,10.14058 23.9126,13.32264 35.3674,20.29924 43.5346,28.34864 17.7824,17.57152 32.0059,48.38188 32.0059,48.38188 -7.4523,0.13974 -7.2213,0.70375 -12.4351,0.93878 z" id="fleche1" class="fleche1" inkscape:connector-curvature="0" sodipodi:nodetypes="cccccsccccc" inkscape:label="#flèche1" /> <g transform="matrix(0.46648632,0,0,1.1215394,230.38141,-17.714399)" id="mfleche" class="mfleche" > <g id="mediumfleche"> <path style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.11298513;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 359.78227,291.12295 70.19187,27.52537 36.06904,-27.5999 -23.88483,-1.32749 c -16.31411,-33.65472 -13.192,-43.68598 -64.50781,-57.34495 -74.24899,-19.7632 -89.29375,-18.36741 -89.29375,-18.36741 l -93.14178,-0.19281 120.30889,26.57089 c 47.25402,10.43631 55.84707,31.71205 74.46766,50.59874 z" id="fleche2-2-2-1" class="fleche2-2-2-1" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccsccscc" inkscape:label="#flèche2" /> <path style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:5.34196901;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 353.74099,282.23583 231.30336,53.29064 122.66486,-52.70641 -79.44073,-2.71037 C 531.18635,210.94096 488.43107,191.7179 388.48008,136.89992 l -165.13812,0.54544 142.43074,90.06701 c 67.91576,41.8241 28.30574,18.30279 88.6098,54.66628 z" id="fleche2-2-0" class="fleche2-2-0" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccccc" inkscape:label="#flèche2" /> </g> </g> <g transform="matrix(0.77353311,0,0,1.1546169,-654.07295,104.97913)" id="m2fleche" class="m2fleche" > <g id="mediumfleche-8"> <path style="display:inline;fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.25925946;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 1346.4584,178.76441 70.1115,31.50433 36.0277,-31.58963 -23.8575,-1.51939 c -24.2679,-44.82997 -61.9153,-63.36972 -109.3432,-73.1752 l -65.6852,-0.20768 48.539,16.91704 c 48.431,16.87943 55.7831,36.29621 74.3824,57.91309 z" id="fleche2-2-2-1-1" class="fleche2-2-2-1-1" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccscc" inkscape:label="#flèche2" /> <path style="display:inline;fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:5.34196901;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 1340.4079,173.94678 231.3034,53.29064 122.6648,-52.70641 -79.4407,-2.71037 C 1517.8533,102.65191 1475.098,83.42885 1375.147,28.610872 l -165.1381,0.54544 142.4307,90.067008 c 67.9158,41.8241 28.3058,18.30279 88.6098,54.66628 z" id="fleche2-2-0-2" class="fleche2-2-0-2" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccccc" inkscape:label="#flèche2" /> </g> </g> <path style="display:inline;fill:#ea002b;fill-opacity:0.76754384;fill-rule:evenodd;stroke:#ffffff;stroke-width:4.61999989;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 307.74504,126.34613 110.2441,-1.39354 52.5087,-87.320159 18.922,-0.49331 -34.5561,-33.8553399 -87.4965,28.9990399 22.8742,0.30814 z" id="path24839" class="path24839" inkscape:connector-curvature="0" sodipodi:nodetypes="cccccccc" /> <g id="bigfleche" class="bigfleche" transform="matrix(0.99905145,0,0,1.1284338,1.1804538,-15.740372)"> <path inkscape:label="#flèche2" sodipodi:nodetypes="ccccsccccc" inkscape:connector-curvature="0" id="fleche2-2-2" class="fleche2-2-2" d="m 364.22667,299.57474 68.8303,29.6041 36.50211,-29.27955 -23.63964,-1.50567 c -15.25803,-35.9321 -7.10423,-37.91812 -33.8646,-66.47443 -9.32385,-9.9496 -37.49066,-13.08172 -37.49066,-13.08172 l -49.14113,0.30301 42.38397,50.03418 c 20.21009,23.2342 8.4231,10.16761 26.36813,30.36832 z" style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:2.17195487;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> <path inkscape:label="#flèche2" sodipodi:nodetypes="ccccsccccc" inkscape:connector-curvature="0" id="fleche2-2" class="fleche2-2" d="m 364.71109,282.23583 231.30336,53.29064 122.66483,-52.70641 -79.4407,-2.71037 C 627.36013,228.55995 611.40146,192.73289 513.31522,159.43827 448.64752,137.4873 399.45018,136.89992 399.45018,136.89992 l -165.13812,0.54544 142.43074,90.06701 c 67.91576,41.8241 28.30574,18.30279 88.6098,54.66628 z" style="fill:#c83737;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:5.34196901;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" /> </g> <path style="display:inline;fill:#ea002b;fill-opacity:0.76754384;fill-rule:evenodd;stroke:#ffffff;stroke-width:4.6420002;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 6.293743,444.70182 178.374697,0.032 c 0,0 65.6515,-100.67435 95.6415,-135.35128 27.1088,-31.3454 87.8644,-89.93625 87.8644,-89.93625 l -38.7027,-1.06529 85.1458,-82.02763 -166.4213,0 85.1458,-103.333509 23.2216,-10e-6 -25.1567,-27.1649803 -62.5693,26.0996903 24.5117,0 c 0,0 -89.2819,95.796339 -126.4286,152.337039 C 133.61264,234.98921 2.881543,453.59298 6.293743,444.70182 Z" id="path24817" class="path24817" inkscape:connector-curvature="0" sodipodi:nodetypes="ccscccccccccsc" /> </g> </svg>';

        $container.find(".svgyellowarr").append(svgyellowarrow);
        $container.find(".aniflex").append(bgandarrows);

        $container.find(".consigne").append("<div class='action'><div class='moins grade'> - moins </div>  <div class='slider'></div><div class='plus grade'> + plus</div> </div><input class='ranger' type='number' hidden>");

        $(".slider").slider({
            value:0,
            min: 0,
            max: 100,
            slide: function (event, ui) {
                answ = ui.value/100;
                $container.find(".efdsasw").append(answ+","); 

                var seuil = ui.value / 100;
              
                if (seuil < 0.26) {
                    $smallfleche.show();
                    $fleche1.show();
                    $mfleche.hide();
                    $m2fleche.hide();
                    $bigfleche.hide();
                }
                else if (seuil > 0.25 && seuil < 0.51) {
                    $smallfleche.hide();
                    $fleche1.hide();
                    $mfleche.show();
                    $m2fleche.hide();
                    $bigfleche.hide();
                }
                else if (seuil > 0.5 && seuil < 0.76) {
                    $smallfleche.hide();
                    $fleche1.hide();
                    $mfleche.hide();
                    $m2fleche.show();
                    $bigfleche.hide();
                }
                else if (seuil > 0.75) {
                    $smallfleche.hide();
                    $fleche1.hide();
                    $mfleche.hide();
                    $m2fleche.hide();
                    $bigfleche.show();
                }

                var opaco = seuil - 0.1;
                $container.find(".atmos").css("background-color", "rgba(255, 255, 255," + opaco + ")");
            }
        });

        var $ranger = $container.find(".ranger");
        var $smallfleche = $container.find(".smallfleche");
        var $fleche1 = $container.find(".fleche1");
        var $mfleche = $container.find(".mfleche");
        var $m2fleche = $container.find(".m2fleche");
        var $bigfleche = $container.find(".bigfleche");

        $ranger.attr("min", "0");
        $ranger.attr("max", "0.8");
        $ranger.attr("step", "0.1");
        $ranger.attr("value", "0");

    }

    

    return {
        render: function(id, container, config, assetManager) {

            var $container = $(container);

            renderChoices(id, $container, config);
        }
    };
});